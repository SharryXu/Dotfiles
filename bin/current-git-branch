#!/bin/bash

# Acquire current git branch name.
# Globals:
#   git
#   is-git-repo
#   print
# Arguments:
#   folder path
# Returns:
#   IsAlive

function usage() {
  echo -e "\nusage: $(basename $0) folder_path"
  exit 1
}

if [[ $# -eq 1 ]]; then
  folder_path=$(realpath "$1")
else
  folder_path=$(realpath ".")
fi

if is-git-repo $folder_path; then
  cd $folder_path
  branch_name="$(git symbolic-ref --short HEAD 2>/dev/null)"
  if [[ $? != 0 ]]; then
    print 3 "Not on any branch."
    exit 1
  else
    print 1 $branch_name
    cd - 1>/dev/null 2>&1
  fi
else
  print 3 "$folder_path is not a valid git repository."
  exit 1
fi
